<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>QR Code Scanner and Generator</title>
    <link rel="stylesheet" href="style.css">
    <style>
      body {
    font-family: 'Arial', sans-serif;
    background-color: #000;
    color: #fff;
    margin: 0;
    padding: 0;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

.container {
    text-align: center;
    max-width: 600px;
    width: 100%;
    padding: 20px;
}

header h1 {
    margin-bottom: 20px;
    font-size: 24px;
}

button, input {
    background-color: #333;
    color: white;
    border: none;
    padding: 10px;
    margin: 10px 0;
    width: 80%;
    max-width: 300px;
    font-size: 16px;
    cursor: pointer;
}

button:hover, input:focus {
    background-color: #444;
}

#qr-video {
    width: 100%;
    max-width: 300px;
}

#qr-code-container {
    margin-top: 20px;
}

#history-list {
    list-style-type: none;
    padding: 0;
}

#history-list li {
    background-color: #333;
    margin: 5px 0;
    padding: 10px;
}

    </style>
</head>
<div class="container">
    <header>
        <h1>اسکنر و سازنده QR کد</h1>
    </header>
    <section id="qr-scanner">
        <button id="camera-permission-btn">اجازه دسترسی به دوربین</button>
        <video id="qr-video" style="display:none;"></video>
        <canvas id="qr-canvas" style="display:none;"></canvas>
        <p id="qr-result">نتیجه اسکن: <span id="url-result"></span></p>
    </section>
    <section id="qr-generator">
        <input type="text" id="qr-input" placeholder="آدرس URL یا متن خود را وارد کنید">
        <button id="generate-qr-btn">تولید QR کد</button>
        <div id="qr-code-container"></div>
    </section>
    <section id="history">
        <h2>تاریخچه اسکن‌ها</h2>
        <ul id="history-list"></ul>
    </section>
</div>
<script src="https://cdn.jsdelivr.net/npm/jsqr/dist/jsQR.js"></script>
<script src="script.js"></script>
</body>
    
    <footer class="bg-white py-4 px-6 text-center text-sm text-gray-600 border-t">
        <p>تمامی حقوق محفوظ است © 2023 | اسکنر QR کد</p>
    </footer>

    <script>
// Camera access and QR Code scanning
const cameraPermissionBtn = document.getElementById('camera-permission-btn');
const qrVideo = document.getElementById('qr-video');
const qrCanvas = document.getElementById('qr-canvas');
const qrResult = document.getElementById('qr-result');
const urlResult = document.getElementById('url-result');
const historyList = document.getElementById('history-list');

// Get camera permission
cameraPermissionBtn.addEventListener('click', () => {
    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            qrVideo.srcObject = stream;
            qrVideo.style.display = 'block';
            cameraPermissionBtn.style.display = 'none';
            requestAnimationFrame(scanQRCode);
        })
        .catch(err => {
            alert('دسترسی به دوربین مجاز نیست!');
        });
});

// Scan QR Code
function scanQRCode() {
    if (qrVideo.readyState === qrVideo.HAVE_ENOUGH_DATA) {
        qrCanvas.width = qrVideo.videoWidth;
        qrCanvas.height = qrVideo.videoHeight;
        const context = qrCanvas.getContext('2d');
        context.drawImage(qrVideo, 0, 0, qrCanvas.width, qrCanvas.height);
        const imageData = context.getImageData(0, 0, qrCanvas.width, qrCanvas.height);
        const code = jsQR(imageData.data, qrCanvas.width, qrCanvas.height);
        
        if (code) {
            const url = code.data;
            urlResult.textContent = url;
            saveScanHistory(url);
            qrResult.style.display = 'block';
        }
    }
    requestAnimationFrame(scanQRCode);
}

// Save scan history
function saveScanHistory(url) {
    const historyItem = document.createElement('li');
    historyItem.textContent = url;
    historyList.appendChild(historyItem);
}

// QR Code Generator
const qrInput = document.getElementById('qr-input');
const generateQrBtn = document.getElementById('generate-qr-btn');
const qrCodeContainer = document.getElementById('qr-code-container');

generateQrBtn.addEventListener('click', () => {
    const url = qrInput.value;
    if (url) {
        const qrCode = new QRCode(qrCodeContainer, {
            text: url,
            width: 128,
            height: 128,
            colorDark: "#000000",
            colorLight: "#ffffff",
            correctLevel: QRCode.CorrectLevel.L
        });
    } else {
        alert('لطفاً URL یا متن وارد کنید!');
    }
});

    </script>
</body>
</html>
